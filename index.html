<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="tailwind.css">
    <title>Meal App</title>
</head>
<body>

    <div class="flex flex-col items-center container mx-auto px-4 ">
        <h1 id="meal" class="text-5xl font-black">Titre de la recette</h1>
        <div class="my-8 rounded-xxl shadow-lg overflow-hidden">
            <img id='imageMeal' width="256" src="https:\/\/www.themealdb.com\/images\/media\/meals\/wyxwsp1486979827.jpg"/>
        </div>
        <div class="p-2 bg-pink-50 rounded mb-6">
            <a  class="text-pink-500 background-transparent font-bold uppercase px-6 py-2 text-sm outline-none focus:outline-none mr-1 mb-1" href="">Ajouter aux favoris</a>
        </div>
        <div id="list-ingredient" class="flex flex-row flex-wrap">
            
        </div>
        <p id="instructions" class="rounded bg-gray-50 p-4">Loading instructions...</p>
        
    </div>
    <script src="shake.js"></script>
    <script>
        const ul = document.getElementById("list-ingredient");
        const instructions = document.getElementById("instructions");
        const mealTitle = document.getElementById("meal");
        const imageMeal = document.getElementById("imageMeal");

        var myShakeEvent = new Shake({
            threshold: 15, // optional shake strength threshold
            timeout: 1000 // optional, determines the frequency of event generation
        });
        myShakeEvent.start();

        window.addEventListener('shake', shakeEventDidOccur, false);

        //function to call when shake occurs
        function shakeEventDidOccur () {

            //put your own code here etc.
            console.log('shaked ü§å');
        }
        
        //Charge une recette random
        function loadRandomRecipe() {
            //1. Se connecter √† l'API MealDB
            //On cree la requete
            let requestURL = 'https://www.themealdb.com/api/json/v1/1/random.php';
            let request = new XMLHttpRequest();
            request.open('GET', requestURL);
            request.responseType = 'text';
            
             //2. R√©cuperer une recette random
            //Envoi de la requete
            request.send();

            //Au moment de la r√©cup√©ration (r√©ponse du serveur)
            request.onload = function() {
                //On execute ce code
                const mealText = request.response;
                const meals = JSON.parse(mealText);
                console.log(meals);
                showMeal(meals);
            }
        }
   
        //3. L'afficher de mani√®re jolie
        function showMeal(dataFromServer){
            //On va boucler sur les donn√©es
            var myRecipe = dataFromServer.meals[0];
            
            //Ingredients List
            for(var i=1; i <= 20; i++){
                ingredientValue = myRecipe["strIngredient" + i];
                if(ingredientValue !== ''){
                    const ingredient = document.createElement('div');
                    ingredient.className = 'm-2 p-2 bg-indigo-200 rounded text-indigo-900';
                    ingredient.textContent = ingredientValue;
                    ul.appendChild(ingredient);
                }
            }
            
            //Instructions
            instructionsValue = myRecipe.strInstructions;
            instructions.innerHTML= instructionsValue;
            
            //Title 
            mealTitleValue = myRecipe.strMeal;
            mealTitle.innerHTML = mealTitleValue;

            //image
            imageValue=myRecipe.strMealThumb;
            imageMeal.src=imageValue;

        }

        loadRandomRecipe();
        //4. Ajouter en favoris
    </script>
</body>
</html>